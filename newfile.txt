Updated code by B1
